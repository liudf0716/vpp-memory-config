<!DOCTYPE html>
<html lang="zh-CN">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>VPP Startup.conf å†…å­˜é…ç½®å®Œå…¨æŒ‡å—</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link
        href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700;800&family=JetBrains+Mono:wght@400;500&display=swap"
        rel="stylesheet">
    <style>
        :root {
            --bg-deep: #0f172a;
            --bg-accent: #1e293b;
            --primary: #38bdf8;
            --primary-glow: rgba(56, 189, 248, 0.4);
            --secondary: #818cf8;
            --success: #10b981;
            --warning: #f59e0b;
            --error: #ef4444;
            --text-main: #f8fafc;
            --text-dim: #94a3b8;
            --glass-bg: rgba(30, 41, 59, 0.7);
            --glass-border: rgba(255, 255, 255, 0.1);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', -apple-system, system-ui, sans-serif;
            background-color: var(--bg-deep);
            background-image:
                radial-gradient(at 0% 0%, rgba(56, 189, 248, 0.15) 0px, transparent 50%),
                radial-gradient(at 100% 100%, rgba(129, 140, 248, 0.15) 0px, transparent 50%);
            overflow: hidden;
            color: var(--text-main);
            height: 100vh;
        }

        .presentation {
            width: 100vw;
            height: 100vh;
            position: relative;
            perspective: 1000px;
        }

        .slide {
            position: absolute;
            width: 100%;
            height: 100%;
            display: none;
            padding: 5% 8%;
            opacity: 0;
            transform: translateX(30px);
            transition: all 0.6s cubic-bezier(0.4, 0, 0.2, 1);
            flex-direction: column;
            justify-content: center;
        }

        .slide.active {
            display: flex;
            opacity: 1;
            transform: translateX(0);
        }

        .slide-header {
            text-align: left;
            margin-bottom: 3rem;
            border-left: 6px solid var(--primary);
            padding-left: 2rem;
            animation: slideInLeft 0.8s ease-out;
        }

        @keyframes slideInLeft {
            from {
                opacity: 0;
                transform: translateX(-50px);
            }

            to {
                opacity: 1;
                transform: translateX(0);
            }
        }

        .slide-title {
            font-size: 3.8rem;
            font-weight: 800;
            letter-spacing: -0.02em;
            background: linear-gradient(to right, #fff, var(--primary));
            -webkit-background-clip: text;
            background-clip: text;
            -webkit-text-fill-color: transparent;
            margin-bottom: 0.5rem;
        }

        .slide-subtitle {
            font-size: 1.8rem;
            color: var(--text-dim);
            font-weight: 400;
        }

        .slide-content {
            flex: 1;
            font-size: 1.25rem;
            line-height: 1.7;
            animation: fadeIn 1s ease-out 0.3s both;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(20px);
            }

            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .slide-number {
            position: absolute;
            bottom: 40px;
            right: 50px;
            font-size: 1.2rem;
            color: var(--text-dim);
            font-family: 'JetBrains Mono', monospace;
            opacity: 0.5;
        }

        /* Glassmorphism Components */
        .glass-card {
            background: var(--glass-bg);
            backdrop-filter: blur(12px);
            -webkit-backdrop-filter: blur(12px);
            border: 1px solid var(--glass-border);
            border-radius: 20px;
            padding: 2.5rem;
            box-shadow: 0 20px 50px rgba(0, 0, 0, 0.3);
        }

        .code-block {
            background: #0b0f1a;
            border: 1px solid var(--glass-border);
            color: #e2e8f0;
            padding: 1.5rem;
            border-radius: 12px;
            font-family: 'JetBrains Mono', monospace;
            font-size: 0.95rem;
            margin: 1.5rem 0;
            position: relative;
            overflow: hidden;
            box-shadow: inset 0 2px 4px rgba(0, 0, 0, 0.5);
        }

        .code-block::before {
            content: "";
            position: absolute;
            top: 0;
            left: 0;
            width: 4px;
            height: 100%;
            background: var(--primary);
        }

        .code-comment {
            color: #64748b;
            font-style: italic;
        }

        .code-keyword {
            color: var(--primary);
            font-weight: 600;
        }

        .code-string {
            color: var(--success);
        }

        .code-number {
            color: #f472b6;
        }

        .highlight-box {
            background: rgba(56, 189, 248, 0.1);
            border-left: 4px solid var(--primary);
            padding: 1.5rem;
            border-radius: 0 12px 12px 0;
            margin: 1.2rem 0;
        }

        .warning-box {
            background: rgba(245, 158, 11, 0.1);
            border-left: 4px solid var(--warning);
            padding: 1.5rem;
            border-radius: 0 12px 12px 0;
            margin: 1.2rem 0;
        }

        .error-box {
            background: rgba(239, 68, 68, 0.1);
            border-left: 4px solid var(--error);
            padding: 1.5rem;
            border-radius: 0 12px 12px 0;
            margin: 1.2rem 0;
        }

        .success-box {
            background: rgba(16, 185, 129, 0.1);
            border-left: 4px solid var(--success);
            padding: 1.5rem;
            border-radius: 0 12px 12px 0;
            margin: 1.2rem 0;
        }

        .two-columns {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 2.5rem;
            align-items: center;
        }

        ul {
            list-style: none;
        }

        ul li {
            padding: 0.7rem 0 0.7rem 2rem;
            position: relative;
            transition: transform 0.2s ease;
        }

        ul li:hover {
            transform: translateX(8px);
        }

        ul li:before {
            content: "â†’";
            position: absolute;
            left: 0;
            color: var(--primary);
            font-weight: 800;
        }

        table {
            width: 100%;
            border-collapse: separate;
            border-spacing: 0;
            margin: 2rem 0;
            background: var(--glass-bg);
            border-radius: 12px;
            overflow: hidden;
            border: 1px solid var(--glass-border);
        }

        th {
            background: rgba(56, 189, 248, 0.1);
            color: var(--primary);
            padding: 1.2rem;
            text-align: left;
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 0.05em;
            border-bottom: 1px solid var(--glass-border);
        }

        td {
            padding: 1rem 1.2rem;
            border-bottom: 1px solid rgba(255, 255, 255, 0.05);
            color: #e2e8f0;
        }

        tr:last-child td {
            border-bottom: none;
        }

        tr:hover td {
            background: rgba(255, 255, 255, 0.03);
        }

        .slide.active .slide-content>* {
            animation: fadeInUp 0.6s ease-out both;
        }

        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(30px);
            }

            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .icon {
            font-size: 1.2em;
            margin-right: 8px;
        }

        .progress-bar {
            position: fixed;
            top: 0;
            left: 0;
            height: 4px;
            background: linear-gradient(90deg, var(--primary) 0%, var(--secondary) 100%);
            box-shadow: 0 0 15px var(--primary-glow);
            transition: width 0.4s cubic-bezier(0.17, 0.67, 0.83, 0.67);
            z-index: 1001;
        }
    </style>
</head>

<body>
    <div class="progress-bar" id="progressBar"></div>

    <div class="presentation" id="presentation">
        <!-- Slide 1: Title -->
        <div class="slide active">
            <div class="slide-content" style="text-align: center;">
                <div class="glass-card"
                    style="display: inline-block; padding: 4rem 6rem; border: 2px solid var(--primary);">
                    <h1 class="slide-title" style="font-size: 4.8rem; margin-bottom: 2rem; line-height: 1.1;">
                        VPP Startup.conf<br><span style="color: var(--secondary);">å†…å­˜é…ç½®å…¨è§£æ</span>
                    </h1>
                    <p class="slide-subtitle" style="font-size: 2rem; color: var(--text-dim); margin-bottom: 3rem;">
                        20,000 PPPoE çœŸå®æ¡ˆä¾‹é©±åŠ¨
                    </p>
                    <div
                        style="height: 2px; background: linear-gradient(to right, transparent, var(--primary), transparent); margin: 3rem 0;">
                    </div>
                    <p style="font-size: 1.4rem; font-weight: 500; color: var(--primary);">æ·±åº¦æ€§èƒ½ä¼˜åŒ– | ç”Ÿäº§çº§é…ç½®æŒ‡å—</p>
                </div>
            </div>
            <div class="slide-number">1</div>
        </div>

        <!-- Slide 2: ç›®å½• -->
        <div class="slide">
            <div class="slide-header">
                <h2 class="slide-title">è¯¾ç¨‹å¤§çº²</h2>
            </div>
            <div class="slide-content">
                <div class="three-columns">
                    <div class="glass-card">
                        <h3 style="color: var(--primary); margin-bottom: 1.5rem;">ğŸ“‹ åŸºç¡€ç¯‡</h3>
                        <ul style="font-size: 1.1rem;">
                            <li>VPP å†…å­˜æ¶æ„æ¦‚è§ˆ</li>
                            <li>å†…å­˜åˆ†ç±»ä¸ç”¨é€”</li>
                            <li>Main Heap è¯¦è§£</li>
                        </ul>
                    </div>
                    <div class="glass-card">
                        <h3 style="color: var(--secondary); margin-bottom: 1.5rem;">âš ï¸ æ ¸å¿ƒç¯‡</h3>
                        <ul style="font-size: 1.1rem;">
                            <li>Stats Segment (é‡ç‚¹)</li>
                            <li>API Segment é…ç½®</li>
                            <li>PPPoE åœºæ™¯ä¼˜åŒ–</li>
                        </ul>
                    </div>
                    <div class="glass-card">
                        <h3 style="color: var(--success); margin-bottom: 1.5rem;">ğŸš€ å®æˆ˜ç¯‡</h3>
                        <ul style="font-size: 1.1rem;">
                            <li>2ä¸‡ PPPoE æ¡ˆä¾‹åˆ†æ</li>
                            <li>æ€§èƒ½ä¼˜åŒ–å»ºè®®</li>
                            <li>é—®é¢˜æ’æŸ¥æµç¨‹</li>
                        </ul>
                    </div>
                </div>
            </div>
            <div class="slide-number">2</div>
        </div>

        <!-- Slide 3: VPP å†…å­˜æ¶æ„å…¨æ™¯ -->
        <div class="slide">
            <div class="slide-header">
                <h2 class="slide-title">VPP å†…å­˜æ¶æ„å…¨æ™¯å›¾</h2>
            </div>
            <div class="slide-content">
                <div class="glass-card" style="border: 1px solid var(--primary);">
                    <div class="two-columns">
                        <div>
                            <div class="error-box" style="margin-bottom: 2rem;">
                                <h3 style="color: var(--error); margin-bottom: 1rem;">ğŸ”¥ Main Heap (heapsize)</h3>
                                <p style="font-size: 1.1rem;">ä¸»çº¿ç¨‹ + Worker çº¿ç¨‹å†…å­˜ã€‚å­˜æ”¾è·¯ç”±è¡¨ã€PPPoE ä¼šè¯ã€è™šæ‹Ÿæ¥å£ã€‚é‡å‹åŠ›ä¸‹æœ€æ˜“ OOMï¼å»ºè®®
                                    <strong>2G-3G+</strong>
                                </p>
                            </div>
                            <div class="highlight-box">
                                <h3 style="color: var(--primary); margin-bottom: 1rem;">ğŸ“Š Stats Segment (statseg)</h3>
                                <p style="font-size: 1.1rem;">PPPoE æ¥å£ç»Ÿè®¡è®¡æ•°å™¨ã€‚2w PPPoE çº¦éœ€ <strong>256M</strong> (é»˜è®¤ 32M
                                    ææ˜“æº¢å‡º)ã€‚</p>
                            </div>
                        </div>
                        <div class="architecture-diagram"
                            style="font-size: 0.9rem; line-height: 1.5; color: var(--secondary);">
                            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”<br>
                            â”‚ VPP Process (Huge Pages) â”‚<br>
                            â”œâ”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”¤<br>
                            â”‚ Main â”‚ Stats â”‚ API â”‚ Bufferâ”‚<br>
                            â”‚ Heap â”‚ Seg â”‚ Seg â”‚ Pool â”‚<br>
                            â”œâ”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”¤<br>
                            â”‚ R/W â”‚ R/O â”‚ Ring â”‚ HW â”‚<br>
                            â””â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”˜
                        </div>
                    </div>
                </div>
            </div>
            <div class="slide-number">3</div>
        </div>

        <!-- Slide 4: å†…å­˜ç±»å‹å¯¹æ¯” -->
        <div class="slide">
            <div class="slide-header">
                <h2 class="slide-title">å†…å­˜ç±»å‹å¯¹æ¯”</h2>
            </div>
            <div class="slide-content">
                <table>
                    <thead>
                        <tr>
                            <th>å†…å­˜æ®µ</th>
                            <th>é…ç½®å‚æ•°</th>
                            <th>é»˜è®¤å¤§å°</th>
                            <th>ä¸»è¦ç”¨é€”</th>
                            <th>OOM é£é™©</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><strong>Main Heap</strong></td>
                            <td><code>heapsize</code></td>
                            <td>1G</td>
                            <td>è·¯ç”±ã€PPPoEä¼šè¯ã€æ¥å£</td>
                            <td style="color: #dc3545; font-weight: 700;">ğŸ”¥ é«˜ (é‡å‹æ˜“ OOM)</td>
                        </tr>
                        <tr>
                            <td><strong>Stats Segment</strong></td>
                            <td><code>statseg { size }</code></td>
                            <td>32M</td>
                            <td>PPPoE æ¥å£ç»Ÿè®¡</td>
                            <td style="color: #ffc107;">âš ï¸ ä¸­ (å¤§é‡ç»Ÿè®¡æ˜“ OOM)</td>
                        </tr>
                        <tr>
                            <td><strong>API Segment</strong></td>
                            <td><code>api-segment { global-size }</code></td>
                            <td>global: 64M</td>
                            <td>API é€šä¿¡</td>
                            <td style="color: #28a745;">âœ… ä½ (æå°‘ OOM)</td>
                        </tr>
                        <tr>
                            <td><strong>NUMA Heaps</strong></td>
                            <td><code>physmem { ... }</code></td>
                            <td>æŒ‰ç³»ç»Ÿ</td>
                            <td>NUMA ä¼˜åŒ–</td>
                            <td style="color: #28a745;">âœ… ä½</td>
                        </tr>
                    </tbody>
                </table>
                <div class="error-box" style="margin-top: 30px;">
                    <strong>ğŸ”¥ é‡ç‚¹è®°å¿†ï¼š</strong> Main Heap æ˜¯å¤§å‹åŠ›åœºæ™¯ä¸‹çš„ OOM é‡åŒºï¼
                </div>
            </div>
            <div class="slide-number">4</div>
        </div>

        <!-- Slide 5: Main Heap è¯¦è§£ -->
        <div class="slide">
            <div class="slide-header">
                <h2 class="slide-title">Main Heap è¯¦è§£</h2>
            </div>
            <div class="slide-content">
                <div class="two-columns">
                    <div>
                        <h3 style="color: #667eea; margin-bottom: 20px;">é…ç½®ç¤ºä¾‹</h3>
                        <div class="code-block">
                            <span class="code-comment"># startup.conf</span>
                            <span class="code-keyword">heapsize</span> <span class="code-number">3G</span>

                            <span class="code-comment"># æˆ–æ›´è¯¦ç»†</span>
                            <span class="code-keyword">heapsize</span> <span class="code-number">3072M</span>
                        </div>
                        <h3 style="color: #667eea; margin: 30px 0 20px;">ç”¨é€”</h3>
                        <ul>
                            <li>FIB/LPM è·¯ç”±è¡¨</li>
                            <li>PPPoE ä¼šè¯çŠ¶æ€</li>
                            <li>ARP/ND è¡¨</li>
                            <li>æ¥å£æ•°æ®ç»“æ„</li>
                            <li>æ’ä»¶å…ƒæ•°æ®å’Œæ§åˆ¶ç»“æ„</li>
                        </ul>
                        <div class="warning-box" style="margin-top: 15px; font-size: 0.9em;">
                            <strong>æ³¨æ„ï¼š</strong>æ•°æ®åŒ…ç¼“å†²åŒº(buffers)åœ¨ç‹¬ç«‹çš„å†…å­˜åŒºåŸŸï¼Œé€šè¿‡ <code>buffers-per-numa</code> é…ç½®
                        </div>
                    </div>
                    <div>
                        <h3 style="color: #667eea; margin-bottom: 20px;">å¤§å°è®¡ç®—å…¬å¼</h3>
                        <div class="formula">
                            Main Heap = åŸºç¡€å¼€é”€ + æ•°æ®åŒ…ç¼“å†²<br>
                            + è·¯ç”±è¡¨ + è¿æ¥çŠ¶æ€ + æ’ä»¶éœ€æ±‚
                        </div>
                        <h3 style="color: #667eea; margin: 30px 0 20px;">æ¨èé…ç½®</h3>
                        <div class="success-box">
                            <strong>è½»é‡çº§(PPPoE<1k)ï¼š< /strong> 1-2G<br>
                                    <strong>ä¸­å¤§è§„æ¨¡(PPPoE 1k-2w)ï¼š</strong> 2-3G<br>
                                    <strong>è¶…å¤§è§„æ¨¡(PPPoE>2w)ï¼š</strong> 4-8G æˆ–æ›´é«˜
                        </div>
                        <h3 style="color: #667eea; margin: 30px 0 20px;">ç›‘æ§å‘½ä»¤</h3>
                        <div class="code-block">
                            vppctl show memory main-heap
                            vppctl show threads
                        </div>
                    </div>
                </div>
            </div>
            <div class="slide-number">5</div>
        </div>

        <!-- Slide 6: Main Heap å’Œ Stats Segment çš„ OOM åœºæ™¯ -->
        <div class="slide">
            <div class="slide-header">
                <h2 class="slide-title">ğŸ”¥ å¤§è§„æ¨¡ PPPoE éƒ¨ç½²çš„å†…å­˜æŒ‘æˆ˜</h2>
            </div>
            <div class="slide-content">
                <div class="two-columns">
                    <div>
                        <div class="error-box" style="margin-bottom: 20px;">
                            <h3 style="margin-bottom: 15px;">Main Heap (é»˜è®¤ 1G)</h3>
                            <p>å¤§é‡ PPPoE ä¼šè¯ã€è·¯ç”±è¡¨æ—¶æ˜“ OOM</p>
                        </div>
                        <table style="font-size: 0.9em;">
                            <thead>
                                <tr>
                                    <th>PPPoE ä¼šè¯è§„æ¨¡</th>
                                    <th>å»ºè®® heapsize</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>
                                        < 1,000</td>
                                    <td style="color: #28a745;">1-2G</td>
                                </tr>
                                <tr>
                                    <td>1,000 - 10,000</td>
                                    <td style="color: #ffc107;">2-3G</td>
                                </tr>
                                <tr style="background: #d4edda;">
                                    <td>10,000 - 20,000</td>
                                    <td style="color: #28a745; font-weight: 700;">3G (å®æµ‹éªŒè¯)</td>
                                </tr>
                                <tr style="background: #fff3cd;">
                                    <td>> 20,000</td>
                                    <td style="color: #ffc107; font-weight: 700;">4G+</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                    <div>
                        <div class="warning-box" style="margin-bottom: 20px;">
                            <h3 style="margin-bottom: 15px;">Stats Segment (é»˜è®¤ 32M)</h3>
                            <p>å¤§é‡ PPPoE æ¥å£ç»Ÿè®¡æ—¶æ˜“ OOM</p>
                        </div>
                        <table style="font-size: 0.9em;">
                            <thead>
                                <tr>
                                    <th>PPPoE ä¼šè¯æ•°é‡</th>
                                    <th>å»ºè®® statseg size</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>
                                        < 1,000</td>
                                    <td style="color: #28a745;">32M (é»˜è®¤)</td>
                                </tr>
                                <tr>
                                    <td>1,000 - 10,000</td>
                                    <td style="color: #ffc107;">64-128M</td>
                                </tr>
                                <tr style="background: #d4edda;">
                                    <td>10,000 - 20,000</td>
                                    <td style="color: #28a745; font-weight: 700;">256M (å®æµ‹: 41%ä½¿ç”¨ç‡)</td>
                                </tr>
                                <tr style="background: #fff3cd;">
                                    <td>> 20,000</td>
                                    <td style="color: #ffc107; font-weight: 700;">512M+</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
            <div class="slide-number">6</div>
        </div>

        <!-- Slide 7: Stats Segment è®¡ç®—å…¬å¼ -->
        <div class="slide">
            <div class="slide-header">
                <h2 class="slide-title">Stats Segment å¤§å°è®¡ç®—</h2>
            </div>
            <div class="slide-content">
                <div class="highlight-box" style="margin-bottom: 30px;">
                    <h3 style="color: #667eea; margin-bottom: 15px;">ğŸ“Š Stats Segment å­˜å‚¨å†…å®¹</h3>
                    <ul style="font-size: 1.1em;">
                        <li><strong>ç®€å•è®¡æ•°å™¨ (counter_t)</strong>ï¼š8 å­—èŠ‚/è®¡æ•°å™¨</li>
                        <li><strong>ç»„åˆè®¡æ•°å™¨ (vlib_counter_t)</strong>ï¼š16 å­—èŠ‚/è®¡æ•°å™¨ (packets + bytes)</li>
                        <li>æ¯ä¸ª PPPoE æ¥å£æœ‰å¤šä¸ªè®¡æ•°å™¨ (rx/tx packets, bytes, drops, errors ç­‰)</li>
                    </ul>
                </div>
                <div class="formula" style="font-size: 1.3em; margin-bottom: 40px;">
                    ç»éªŒå…¬å¼ï¼šStats Segment â‰ˆ åŸºç¡€å¼€é”€ + (PPPoEä¼šè¯æ•° Ã— çº¿ç¨‹æ•° Ã— ~500 å­—èŠ‚)
                </div>
                <h3 style="color: #667eea; margin: 30px 0 20px; text-align: center;">æ¨èé…ç½®</h3>
                <div class="three-columns">
                    <div class="card">
                        <h3>&lt; 1,000 PPPoE</h3>
                        <div class="code-block">
                            statseg {
                            size <span class="code-number">32M</span> <span class="code-comment"># é»˜è®¤</span>
                            }</div>
                    </div>
                    <div class="card" style="border-top-color: #28a745;">
                        <h3>1,000 - 10,000 PPPoE</h3>
                        <div class="code-block">
                            statseg {
                            size <span class="code-number">128M</span>
                            }</div>
                    </div>
                    <div class="card" style="border-top-color: #ffc107;">
                        <h3>&gt; 10,000 PPPoE â­</h3>
                        <div class="code-block">
                            statseg {
                            size <span class="code-number">256M</span> <span class="code-comment"># 2w PPPoE å®æµ‹å¤Ÿç”¨</span>
                            }</div>
                    </div>
                </div>
                <h3 style="color: #667eea; margin: 20px 0 10px; text-align: center;">ç›‘æ§ä¸è¯Šæ–­</h3>
                <div class="code-block" style="width: 50%; margin: 10px auto; text-align: center;">
                    vppctl show stats-segment
                </div>
            </div>
            <div class="slide-number">7</div>
        </div>

        <!-- Slide 8: çœŸå®æ¡ˆä¾‹ - 2ä¸‡æ¥å£æˆåŠŸéƒ¨ç½² -->
        <div class="slide">
            <div class="slide-header">
                <h2 class="slide-title">çœŸå®æ¡ˆä¾‹ï¼š2ä¸‡ PPPoE æ‹¨å·å®¢æˆ·ç«¯å‹æµ‹éªŒè¯</h2>
            </div>
            <div class="slide-content">
                <div class="two-columns">
                    <div>
                        <h3 style="color: #28a745; margin-bottom: 20px;">âœ… éƒ¨ç½²é…ç½®</h3>
                        <div class="success-box">
                            <strong>åœºæ™¯ï¼š</strong>PPPoX å®¢æˆ·ç«¯å‹åŠ›æµ‹è¯•
                            <ul style="margin-top: 10px;">
                                <li><strong>20,000</strong> PPPoX æ¥å£åˆ›å»º</li>
                                <li><strong>20,000</strong> æ´»è·ƒä¼šè¯ (100% RUNNING)</li>
                                <li>5 çº¿ç¨‹ (1 main + 4 workers)</li>
                                <li>Main heap: <strong>3G</strong></li>
                                <li>Stats segment: <strong>256M</strong></li>
                            </ul>
                        </div>
                        <h3 style="color: #667eea; margin: 20px 0 15px;">ğŸ“Š å®æµ‹å†…å­˜ä½¿ç”¨ (å…¨é‡ 2ä¸‡ä¼šè¯)</h3>
                        <div class="code-block" style="font-size: 0.85em;">
                            <span class="code-comment"># Stats Segment</span>
                            total: <span class="code-number">256M</span>, used: <span class="code-number">109.89M</span>
                            (<span class="code-string">43%</span>)
                            free: 146.10M, trimmable: 120.33M

                            <span class="code-comment"># Main Heap (å…¨é‡ 2w PPPoE)</span>
                            total: <span class="code-number">3G</span>, used: <span class="code-number">656.47M</span>
                            (<span class="code-string">21.9%</span>)
                            free: 2.36G, trimmable: 2.13G
                        </div>
                        <div class="success-box" style="margin-top: 15px; font-size: 0.85em;">
                            <strong>âœ… 2ä¸‡ PPPoE å…¨é‡ä¼šè¯å®æµ‹éªŒè¯ï¼š</strong><br>
                            â€¢ Main Heap: 656M (3G å……è¶³ âœ…)<br>
                            â€¢ Stats Segment: 110M (256M å……è¶³ âœ…)
                        </div>
                    </div>
                    <div>
                        <h3 style="color: #667eea; margin-bottom: 20px;">ğŸ” å…³é”®æŒ‡æ ‡éªŒè¯</h3>
                        <div class="highlight-box">
                            <table style="font-size: 0.9em; margin: 0;">
                                <tr>
                                    <td><strong>PPPoX æ¥å£æ€»æ•°</strong></td>
                                    <td style="color: #28a745;">20,000</td>
                                </tr>
                                <tr>
                                    <td><strong>æ´»è·ƒä¼šè¯ (RUNNING)</strong></td>
                                    <td style="color: #28a745;">20,000 (100% âœ…)</td>
                                </tr>
                                <tr>
                                    <td><strong>API Ring Misses</strong></td>
                                    <td style="color: #28a745;">0 (å®Œç¾)</td>
                                </tr>
                                <tr>
                                    <td><strong>Stats ä½¿ç”¨ç‡</strong></td>
                                    <td style="color: #28a745;">41.5% (å®‰å…¨)</td>
                                </tr>
                                <tr>
                                    <td><strong>Main Heap ä½¿ç”¨ç‡</strong></td>
                                    <td style="color: #28a745;">21.9% (å……è¶³)</td>
                                </tr>
                            </table>
                        </div>
                        <h3 style="color: #28a745; margin: 20px 0 15px;">âœ… éªŒè¯ç»“è®º</h3>
                        <div class="success-box" style="font-size: 0.95em;">
                            <div class="code-block" style="font-size: 0.85em;">
                                <span class="code-keyword">heapsize</span> <span class="code-number">3G</span> <span
                                    class="code-comment"># 2ä¸‡ PPPoE å®æµ‹å¤Ÿç”¨</span>

                                <span class="code-keyword">statseg</span> {
                                <span class="code-keyword">size</span> <span class="code-number">256M</span> <span
                                    class="code-comment"># 2ä¸‡ PPPoE å®æµ‹å¤Ÿç”¨</span>
                                }
                            </div>
                            <p style="margin-top: 10px;"><strong>ç»“è®ºï¼š</strong>3G Main Heap + 256M Stats å¯ç¨³å®šæ”¯æŒå…¨é‡
                                <strong>20,000</strong> PPPoE ä¼šè¯
                            </p>
                        </div>
                    </div>
                </div>
            </div>
            <div class="slide-number">8</div>
        </div>

        <!-- Slide 9: é™æ€èµ„æºå‹åŠ›åˆ†æ -->
        <div class="slide">
            <div class="slide-header">
                <h2 class="slide-title">é™æ€èµ„æºå‹åŠ›ï¼š2ä¸‡æ¥å£çš„ã€Œå…¥åœºè´¹ã€</h2>
            </div>
            <div class="slide-content">
                <div class="two-columns">
                    <div>
                        <h3 style="color: #667eea; margin-bottom: 20px;">ä»€ä¹ˆå«ã€Œé™æ€å‹åŠ›ã€ï¼Ÿ</h3>
                        <div class="highlight-box">
                            <p>å³ä¾¿<strong>æ²¡æœ‰ä»»ä½•æµé‡</strong>ï¼Œä»…ä»…åˆ›å»ºå¹¶ç»´æŒ 20,000 ä¸ªä¼šè¯ä¹Ÿä¼šäº§ç”Ÿæ˜¾è‘—çš„èµ„æºæ¶ˆè€—ï¼š</p>
                            <ul style="margin-top: 15px;">
                                <li><strong>æ¥å£å…ƒæ•°æ®</strong>ï¼šæ¯ä¸ªè½¯ä»¶æ¥å£éƒ½æœ‰ä¸ä¹‹å…³è”çš„æè¿°ç¬¦å’Œç®¡æ§ç»“æ„ã€‚</li>
                                <li><strong>çŠ¶æ€æœºå®šæ—¶å™¨</strong>ï¼šæ¯ä¸ª PPPoE ä¼šè¯éƒ½åœ¨ç»´æŠ¤ LCP/Keepalive å®šæ—¶å™¨ã€‚</li>
                                <li><strong>ARP/FIB è¡¨é¡¹</strong>ï¼š2ä¸‡ä¸ª IP/MAC ç»‘å®šçš„é™æ€å­˜å‚¨æˆæœ¬ã€‚</li>
                            </ul>
                        </div>
                        <div class="error-box" style="margin-top: 20px;">
                            <strong>ğŸ”¥ æ ¸å¿ƒæ•™è®­ï¼š</strong>ä¸è¦ä»¥ä¸ºç©ºè½½å°±ä¸éœ€è¦å†…å­˜ï¼2ä¸‡ PPPoE çš„ã€Œåº•å™ªã€å°±éœ€è¦çº¦ 650M Main Heapã€‚
                        </div>
                    </div>
                    <div>
                        <h3 style="color: #667eea; margin-bottom: 20px;">2ä¸‡è§„æ¨¡ä¸‹çš„åº•å™ªæŒ‡æ ‡</h3>
                        <table>
                            <tr>
                                <th>æŒ‡æ ‡é¡¹</th>
                                <th>2ä¸‡ä¼šè¯å®æµ‹ (ç©ºè½½)</th>
                            </tr>
                            <tr>
                                <td>Main Heap Used</td>
                                <td style="color: #28a745;">~656MB</td>
                            </tr>
                            <tr>
                                <td>Stats Used</td>
                                <td style="color: #28a745;">~110MB</td>
                            </tr>
                            <tr>
                                <td>VPP è¿›ç¨‹ RSS</td>
                                <td style="color: #ffc107;">~1.2GB+</td>
                            </tr>
                        </table>
                        <div class="success-box" style="margin-top: 20px;">
                            <strong>å»ºè®®ï¼š</strong>å¯¹äº 2w+ è§„æ¨¡ï¼Œå³ä¾¿ä¸è·‘å¤§æµé‡ï¼Œ<code>heapsize</code> ä¹Ÿè¦ä» 3G èµ·æ­¥ï¼Œé¢„ç•™ 50% ä»¥ä¸Šç”¨äºæ³¢åŠ¨ã€‚
                        </div>
                    </div>
                </div>
            </div>
            <div class="slide-number">9</div>
        </div>

        <!-- Slide 10: Buffer æ± ç®¡ç† -->
        <div class="slide">
            <div class="slide-header">
                <h2 class="slide-title">Buffer ç®¡ç†ï¼šç©ºè½½ä¸‹çš„éšå½¢æˆæœ¬</h2>
            </div>
            <div class="slide-content">
                <div class="two-columns">
                    <div>
                        <h3 style="color: #667eea; margin-bottom: 20px;">ğŸ“Š å®æµ‹æ•°æ® (sh buffers)</h3>
                        <div class="code-block">
                            Pool Name Total Avail <strong>Used</strong>
                            default-numa-0 16800 10122 <strong>6119</strong>
                        </div>
                        <div class="highlight-box" style="margin-top: 20px;">
                            <strong>ä¸ºä»€ä¹ˆ Used = 6119ï¼Ÿ</strong><br>
                            å³ä½¿æ²¡æœ‰æ•°æ®åŒ…åœ¨è·‘ï¼ŒVPP çš„æ¥å£ç¯çŠ¶ç¼“å†²åŒº (Interface Rings) å’Œç¡¬ä»¶æè¿°ç¬¦ä¼šé¢„å ä¸€éƒ¨åˆ† Bufferã€‚
                            <p style="margin-top: 10px;">å¹³å‡æ¯ 3.2 ä¸ªæ¥å£ä¼šæ°¸ä¹…å ç”¨ 1 ä¸ª Bufferã€‚</p>
                        </div>
                    </div>
                    <div>
                        <h3 style="color: #dc3545; margin-bottom: 20px;">âš ï¸ æ½œåœ¨é£é™©</h3>
                        <p>é»˜è®¤ buffer æ•°é‡ï¼ˆé€šå¸¸ 1.6w - 3.2wï¼‰åœ¨ 2w+ æ¥å£åœºæ™¯ä¸‹éå¸¸å±é™©ï¼š</p>
                        <ul>
                            <li><strong>æ¥å£åˆ›å»ºå¤±è´¥</strong>ï¼šå¦‚æœ Available æ‰åˆ° 0ï¼Œä¸ä»…æ— æ³•å‘åŒ…ï¼Œæ–°æ¥å£ä¹Ÿæ— æ³•åˆ›å»ºã€‚</li>
                            <li><strong>Mass Dialing ç¬é—´è€—å°½</strong>ï¼šæ•°ä¸‡ä¸ª LCP æŠ¥æ–‡ç¬é—´æ¶Œå…¥ä¼šæŒ¤çˆ†å‰©ä½™ bufferã€‚</li>
                        </ul>
                        <h3 style="color: #28a745; margin-top: 25px;">âœ… æ¨èé…ç½®</h3>
                        <div class="code-block">
                            <span class="code-keyword">buffers</span> {
                            <span class="code-keyword">buffers-per-numa</span> <span class="code-number">131072</span>
                            <span class="code-comment"># å»ºè®® 128k èµ·æ­¥</span>
                            }
                        </div>
                    </div>
                </div>
            </div>
            <div class="slide-number">10</div>
        </div>

        <!-- Slide 11: API Segment è¯¦è§£ -->
        <div class="slide">
            <div class="slide-header">
                <h2 class="slide-title">API Segment é…ç½®è¯¦è§£</h2>
            </div>
            <div class="slide-content">
                <div class="two-columns">
                    <div>
                        <h3 style="color: #667eea; margin-bottom: 20px;">API å†…å­˜æ¶æ„</h3>
                        <div class="highlight-box">
                            <div style="font-family: monospace; font-size: 0.95em; line-height: 1.6;">
                                â”Œâ”€â”€â”€â”€â”€â”€â”€ API Segment å†…å­˜å¸ƒå±€ â”€â”€â”€â”€â”€â”€â”€â”<br>
                                â”‚ â”Œâ”€ api-queue (æ¶ˆæ¯æ’é˜Ÿ) â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚<br>
                                â”‚ â”‚ é»˜è®¤é•¿åº¦: 1024 (æœ€å°å€¼) â”‚ â”‚<br>
                                â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚<br>
                                â”‚ â”Œâ”€ vlib rings (VPPâ†’å®¢æˆ·ç«¯) â”€â”€â”€â”€â” â”‚<br>
                                â”‚ â”‚ 88BÃ—1024, 280BÃ—128, 1048BÃ—64 â”‚ â”‚<br>
                                â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚<br>
                                â”‚ â”Œâ”€ client rings (å®¢æˆ·ç«¯â†’VPP) â”€â”€â” â”‚<br>
                                â”‚ â”‚ 1048BÃ—1024, 2072BÃ—128, 4120BÃ—8â”‚ â”‚<br>
                                â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚<br>
                                â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            </div>
                        </div>
                        <h3 style="color: #667eea; margin: 20px 0 15px;">é…ç½®å‚æ•°</h3>
                        <div class="code-block" style="font-size: 0.85em;">
                            <span class="code-keyword">api-segment</span> {
                            <span class="code-keyword">global-size</span> <span class="code-number">128M</span> <span
                                class="code-comment"># å…¨å±€åŒºåŸŸå¤§å°</span>
                            <span class="code-keyword">api-size</span> <span class="code-number">64M</span> <span
                                class="code-comment"># APIæ®µå¤§å°(é»˜è®¤16M)</span>
                            }

                            <span class="code-keyword">api-queue</span> {
                            <span class="code-keyword">length</span> <span class="code-number">4096</span> <span
                                class="code-comment"># æ¶ˆæ¯é˜Ÿåˆ—é•¿åº¦(é»˜è®¤1024)</span>
                            }
                        </div>
                    </div>
                    <div>
                        <h3 style="color: #667eea; margin-bottom: 20px;">Ring ç»Ÿè®¡è§£è¯»</h3>
                        <div class="code-block" style="font-size: 0.8em;">
                            <span class="code-comment"># vppctl show api ring-stats</span>
                            Owner Size Nitems Hits Misses
                            vlib 88 1024 47222 14365 <span class="code-comment"># âš ï¸ 23% miss</span>
                            vlib 280 128 2501 11866 <span class="code-comment"># ğŸ”¥ 83% miss!</span>
                            vlib 1048 64 354 11535 <span class="code-comment"># ğŸ”¥ 97% miss!</span>
                            clnt 1048 1024 48411 0 <span class="code-comment"># âœ… å®Œç¾</span>
                            11535 ring miss fallback allocations
                        </div>
                        <div class="error-box" style="margin-top: 15px; font-size: 0.9em;">
                            <strong>ğŸ”¥ é—®é¢˜åˆ†æï¼š</strong><br>
                            â€¢ <strong>Misses</strong> è¡¨ç¤º ring ç¼“å†²ä¸è¶³ï¼Œéœ€è¦ fallback åˆ°å †åˆ†é…<br>
                            â€¢ missç‡ > 10% è¯´æ˜é¢„åˆ†é… ring å®¹é‡ä¸è¶³<br>
                            â€¢ 11535 æ¬¡ fallback åˆ†é…ä¼šå½±å“æ€§èƒ½
                        </div>
                        <div class="success-box" style="margin-top: 15px; font-size: 0.9em;">
                            <strong>âœ… å¥åº·çŠ¶æ€åº”è¯¥æ˜¯ï¼š</strong><br>
                            â€¢ æ‰€æœ‰ ring çš„ Misses â‰ˆ 0<br>
                            â€¢ fallback allocations = 0
                        </div>
                        <h3 style="color: #667eea; margin: 20px 0 15px;">ç›‘æ§å‘½ä»¤</h3>
                        <div class="code-block" style="font-size: 0.85em;">
                            vppctl show api ring-stats <span class="code-comment"># Ringä½¿ç”¨æƒ…å†µ</span>
                            vppctl show memory api-segment <span class="code-comment"># å†…å­˜ä½¿ç”¨</span>
                            vppctl show api clients <span class="code-comment"># è¿æ¥çš„å®¢æˆ·ç«¯</span>
                        </div>
                    </div>
                </div>
            </div>
            <div class="slide-number">11</div>
        </div>

        <!-- Slide 12: API Ring ä¼˜åŒ–å®æˆ˜æ¡ˆä¾‹ -->
        <div class="slide">
            <div class="slide-header">
                <h2 class="slide-title">API Ring ä¼˜åŒ–å®æˆ˜æ¡ˆä¾‹</h2>
            </div>
            <div class="slide-content">
                <div class="two-columns">
                    <div>
                        <h3 style="color: #dc3545; margin-bottom: 20px;">âŒ é—®é¢˜ç°è±¡</h3>
                        <div class="code-block" style="font-size: 0.8em;">
                            <span class="code-comment"># å¤§é‡ API è¯·æ±‚åçš„ç»Ÿè®¡</span>
                            vpp# show api ring-stats
                            Owner Size Nitems Hits Misses
                            vlib 88 1024 47222 14365
                            vlib 280 128 2501 11866
                            vlib 1048 64 354 11535
                            <span class="code-string">11535 ring miss fallback allocations</span>

                            vpp# show memory api-segment
                            base 0x130042000, size <span class="code-number">32m</span>, locked
                            total: 32.00M, used: 2.07M, free: 29.93M
                        </div>
                        <div class="error-box" style="margin-top: 15px; font-size: 0.9em;">
                            <strong>é—®é¢˜åŸå› ï¼š</strong><br>
                            â€¢ vlib 280B ring åªæœ‰ 128 ä¸ªæ§½ä½ï¼Œmiss ç‡ 83%<br>
                            â€¢ vlib 1048B ring åªæœ‰ 64 ä¸ªæ§½ä½ï¼Œmiss ç‡ 97%<br>
                            â€¢ å¤§é‡æ¶ˆæ¯éœ€è¦ä»å †åˆ†é…ï¼Œæ€§èƒ½ä¸‹é™
                        </div>
                    </div>
                    <div>
                        <h3 style="color: #28a745; margin-bottom: 20px;">âœ… ä¼˜åŒ–é…ç½®</h3>
                        <div class="code-block" style="font-size: 0.85em;">
                            <span class="code-comment"># startup.conf ä¼˜åŒ–é…ç½®</span>
                            <span class="code-keyword">api-segment</span> {
                            <span class="code-keyword">gid</span> vpp
                            <span class="code-keyword">api-size</span> <span class="code-number">64M</span> <span
                                class="code-comment"># å¢å¤§APIæ®µ</span>
                            <span class="code-keyword">global-size</span> <span class="code-number">128M</span> <span
                                class="code-comment"># å¿…é¡» > api-size</span>
                            }

                            <span class="code-keyword">api-queue</span> {
                            <span class="code-keyword">length</span> <span class="code-number">4096</span> <span
                                class="code-comment"># å¢å¤§é˜Ÿåˆ—å®¹é‡</span>
                            }
                        </div>
                        <div class="warning-box" style="margin-top: 15px; font-size: 0.9em;">
                            <strong>âš ï¸ Ring å¤§å°æ˜¯ç¼–è¯‘æ—¶å›ºå®šçš„ï¼š</strong><br>
                            è‹¥éœ€è°ƒæ•´å•ä¸ª ring çš„ nitemsï¼Œéœ€ä¿®æ”¹æºç ï¼š<br>
                            <code style="font-size: 0.85em;">src/vlibapi/memory_shared.h</code><br>
                            ä¸­çš„ <code>foreach_vl_aring_size</code> å®
                        </div>
                        <div class="success-box" style="margin-top: 15px; font-size: 0.9em;">
                            <strong>âœ… å…¶ä»–ä¼˜åŒ–å»ºè®®ï¼š</strong><br>
                            â€¢ ä½¿ç”¨ Socket API å‡å°‘å…±äº«å†…å­˜å‹åŠ›<br>
                            â€¢ æ‰¹é‡åˆå¹¶ API è¯·æ±‚<br>
                            â€¢ é™ä½ API è°ƒç”¨é¢‘ç‡
                        </div>
                    </div>
                </div>
            </div>
            <div class="slide-number">12</div>
        </div>

        <!-- Slide 13: NUMA ä¼˜åŒ– -->
        <div class="slide">
            <div class="slide-header">
                <h2 class="slide-title">NUMA æ¶æ„ä¼˜åŒ–</h2>
            </div>
            <div class="slide-content">
                <div class="two-columns">
                    <div>
                        <h3 style="color: #667eea; margin-bottom: 20px;">NUMA æ¶æ„ç¤ºæ„å›¾</h3>
                        <div class="architecture-diagram">
                            <div style="font-family: monospace; font-size: 1.1em; line-height: 1.8;">
                                â”Œâ”€â”€â”€â”€â”€â”€â”€â”€ åŒ NUMA èŠ‚ç‚¹æœåŠ¡å™¨ â”€â”€â”€â”€â”€â”€â”€â”€â”<br>
                                â”‚ NUMA Node 0 NUMA Node 1 â”‚<br>
                                â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚<br>
                                â”‚ â”‚ CPU 0-7 â”‚ â”‚ CPU 8-15 â”‚ â”‚<br>
                                â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚<br>
                                â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚<br>
                                â”‚ â”‚ Memory A â”‚ â”‚ Memory B â”‚ â”‚<br>
                                â”‚ â”‚ 64GB â”‚ â”‚ 64GB â”‚ â”‚<br>
                                â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚<br>
                                â”‚ â†‘ â†‘ â”‚<br>
                                â”‚ æœ¬åœ°è®¿é—®å¿« æœ¬åœ°è®¿é—®å¿« â”‚<br>
                                â”‚ è¿œç¨‹è®¿é—®æ…¢ è¿œç¨‹è®¿é—®æ…¢ â”‚<br>
                                â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            </div>
                        </div>
                    </div>
                    <div>
                        <h3 style="color: #667eea; margin-bottom: 20px;">ä¼˜åŒ–é…ç½®</h3>
                        <div class="code-block">
                            <span class="code-comment"># CPU é…ç½®</span>
                            <span class="code-keyword">cpu</span> {
                            <span class="code-keyword">main-core</span> <span class="code-number">0</span>
                            <span class="code-keyword">corelist-workers</span> <span class="code-number">1-15</span>
                            <span class="code-comment"># åªç”¨åŒä¸€ NUMA èŠ‚ç‚¹</span>
                            }

                            <span class="code-comment"># å¯ç”¨å¤§é¡µ</span>
                            <span class="code-keyword">physmem</span> {
                            <span class="code-keyword">main-heap-page-size</span> <span class="code-number">2M</span>
                            }
                        </div>
                        <h3 style="color: #667eea; margin: 30px 0 20px;">ä¸ºä»€ä¹ˆä½¿ç”¨å¤§é¡µï¼Ÿ</h3>
                        <div class="success-box">
                            <strong>æ ‡å‡†é¡µï¼š</strong>4KB<br>
                            <strong>å¤§é¡µï¼š</strong>2MB æˆ– 1GB<br>
                            <hr style="margin: 10px 0;">
                            <strong>ä¼˜åŠ¿ï¼š</strong>
                            <ul>
                                <li>å‡å°‘ TLB miss</li>
                                <li>é™ä½é¡µè¡¨å¼€é”€</li>
                                <li>æå‡ 10-20% æ€§èƒ½</li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
            <div class="slide-number">13</div>
        </div>



        <div class="slide">
            <div class="slide-header">
                <h2 class="slide-title">æ€§èƒ½ä¼˜åŒ–ä¼˜å…ˆçº§</h2>
            </div>
            <div class="slide-content">
                <div class="two-columns">
                    <div class="glass-card" style="border-left: 6px solid var(--error);">
                        <h3 style="color: var(--error); margin-bottom: 25px;">ğŸ”¥ğŸ”¥ğŸ”¥ é«˜ä¼˜å…ˆçº§</h3>
                        <ul style="font-size: 1.3rem;">
                            <li><strong>Stats Segment</strong> è§„æ¨¡è°ƒæ•´</li>
                            <li><strong>Main Heap</strong> è§„æ¨¡è°ƒæ•´</li>
                            <li><strong>Buffer Pool</strong> (2wæ¥å£å¿…å¤‡)</li>
                            <li><strong>Huge Pages</strong> å¯ç”¨</li>
                        </ul>
                    </div>
                    <div>
                        <div class="glass-card" style="border-left: 6px solid var(--warning); margin-bottom: 2rem;">
                            <h3 style="color: var(--warning); margin-bottom: 15px;">â­â­ ä¸­ä¼˜å…ˆçº§</h3>
                            <ul style="font-size: 1.1rem;">
                                <li><strong>NUMA</strong> äº²å’Œæ€§ç¡¬ç»‘å®š</li>
                                <li><strong>API Segment</strong> ç¯çŠ¶ç¼“å†²åŒº</li>
                            </ul>
                        </div>
                        <div class="glass-card" style="border-left: 6px solid var(--primary);">
                            <h3 style="color: var(--primary); margin-bottom: 15px;">â­ ä½ä¼˜å…ˆçº§</h3>
                            <ul style="font-size: 1.1rem;">
                                <li>Worker çº¿ç¨‹ç²¾ç»†åŒ–åˆ†é…</li>
                                <li>Buffer åˆ†é…æ­¥é•¿å¾®è°ƒ</li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
            <div class="slide-number">14</div>
        </div>

        <div class="slide">
            <div class="slide-header">
                <h2 class="slide-title">OOM é—®é¢˜æ’æŸ¥æµç¨‹</h2>
            </div>
            <div class="slide-content">
                <div class="glass-card" style="max-width: 900px; margin: 0 auto; border: 1px solid var(--secondary);">
                    <div style="font-family: 'JetBrains Mono', monospace; font-size: 1.3rem; line-height: 2.2;">
                        <strong style="color: var(--error); font-size: 1.6rem;">VPP Crash (OOM)</strong><br>
                        <span style="color: var(--text-dim);">â”‚</span><br>
                        <span style="color: var(--text-dim);">â”œâ”€â†’</span> <kbd>1</kbd> <strong>å†…æ ¸æ—¥å¿—åˆ†æ</strong><br>
                        <span style="color: var(--text-dim);">â”‚</span> &nbsp; &nbsp; <small
                            style="color: var(--primary);">Searching for "region /global_vm", "stats_vm"</small><br>
                        <span style="color: var(--text-dim);">â”‚</span><br>
                        <span style="color: var(--text-dim);">â”œâ”€â†’</span> <kbd>2</kbd> <strong>å¿«ç…§å†…å­˜çŠ¶æ€</strong><br>
                        <span style="color: var(--text-dim);">â”‚</span> &nbsp; &nbsp; <code
                            style="color: var(--warning);">vppctl show memory [main|stats|api]</code><br>
                        <span style="color: var(--text-dim);">â”‚</span><br>
                        <span style="color: var(--text-dim);">â”œâ”€â†’</span> <kbd>3</kbd> <strong>è¯„ä¼°ä¸šåŠ¡æ‹“æ‰‘</strong><br>
                        <span style="color: var(--text-dim);">â”‚</span> &nbsp; &nbsp; <small
                            style="color: var(--success);">Session count (2w), Route scale, API frequency</small><br>
                        <span style="color: var(--text-dim);">â”‚</span><br>
                        <span style="color: var(--text-dim);">â””â”€â†’</span> <kbd>4</kbd> <strong>å‚ç›´æ‰©å®¹ + é¢„ç•™</strong><br>
                        &nbsp; &nbsp; &nbsp; <span style="color: var(--primary);">è°ƒæ•´ startup.conf -> é‡å¯éªŒè¯</span>
                    </div>
                </div>
            </div>
            <div class="slide-number">15</div>
        </div>

        <div class="slide">
            <div class="slide-header">
                <h2 class="slide-title">å¸¸ç”¨è¯Šæ–­å‘½ä»¤é€ŸæŸ¥</h2>
            </div>
            <div class="slide-content">
                <div class="glass-card" style="padding: 1.5rem;">
                    <table>
                        <thead>
                            <tr>
                                <th>é—®é¢˜ç±»å‹</th>
                                <th>è¯Šæ–­å‘½ä»¤</th>
                                <th>å…³é”®æŒ‡æ ‡</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><strong>å†…å­˜ä¸è¶³</strong></td>
                                <td><code>show memory main-heap</code></td>
                                <td style="color: var(--secondary);">used / total > 80%</td>
                            </tr>
                            <tr>
                                <td><strong>Stats OOM</strong></td>
                                <td><code>show memory stats-segment</code></td>
                                <td style="color: var(--secondary);">used / total > 90%</td>
                            </tr>
                            <tr>
                                <td><strong>Buffer è€—å°½</strong></td>
                                <td><code>show buffers</code></td>
                                <td style="color: var(--secondary);">Avail < 10%</td>
                            </tr>
                            <tr>
                                <td><strong>API Ring ä¸è¶³</strong></td>
                                <td><code>show api ring-stats</code></td>
                                <td style="color: var(--secondary);">ring misses > 10%</td>
                            </tr>
                            <tr>
                                <td><strong>NUMA é—®é¢˜</strong></td>
                                <td><code>show memory numa-heaps</code></td>
                                <td style="color: var(--secondary);">è·¨èŠ‚ç‚¹è®¿é—®</td>
                            </tr>
                            <tr>
                                <td><strong>PPPoE ä¼šè¯æ•°</strong></td>
                                <td><code>show pppox interfaces</code></td>
                                <td style="color: var(--secondary);">20,000 (RUNNING)</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
            <div class="slide-number">16</div>
        </div>

        <div class="slide">
            <div class="slide-header">
                <h2 class="slide-title">å…³é”®è¦ç‚¹æ€»ç»“</h2>
            </div>
            <div class="slide-content">
                <div class="two-columns">
                    <div>
                        <div class="glass-card" style="border-top: 4px solid var(--error); margin-bottom: 2rem;">
                            <h3 style="color: var(--error); margin-bottom: 1rem;">ğŸ”¥ æ ¸å¿ƒç»“è®º</h3>
                            <ul style="font-size: 1.1rem;">
                                <li><strong>Main Heap</strong> æ˜¯æœ€è„†å¼±çš„ç¯èŠ‚ï¼Œ2w æ¥å£å»ºè®® 3G+ã€‚</li>
                                <li><strong>Stats Seg</strong> 32M é»˜è®¤å€¼åœ¨å¤§è§„æ¨¡åœºæ™¯å¿…æ»¡ï¼Œå»ºè®® 256Mã€‚</li>
                                <li><strong>Buffers</strong> å¹¶ä¸æ˜¯åªå¸¦æµé‡æ‰æ‰£ï¼Œå¤§è§„æ¨¡æ¥å£é¢„å ä¸¥é‡ã€‚</li>
                            </ul>
                        </div>
                        <div class="glass-card" style="border-top: 4px solid var(--success);">
                            <h3 style="color: var(--success); margin-bottom: 1rem;">âœ… æ¨èå‚æ•° (2wä¼šè¯)</h3>
                            <div class="code-block" style="font-size: 0.9rem; margin-bottom: 0;">
                                main-heap-size 3G<br>
                                statseg { size 256M }<br>
                                buffers { buffers-per-numa 131072 }
                            </div>
                        </div>
                    </div>
                    <div>
                        <div class="glass-card" style="border-top: 4px solid var(--primary); margin-bottom: 2rem;">
                            <h3 style="color: var(--primary); margin-bottom: 1rem;">ğŸ”§ è¿›é˜¶ä¼˜åŒ–</h3>
                            <ul style="font-size: 1.1rem;">
                                <li>API Segment é»˜è®¤ 64M/128M ç»„åˆé€šå¸¸å¤Ÿç”¨ã€‚</li>
                                <li>NUMA äº²å’Œæ€§ç»‘å®šå¯æå‡ 10-20% ååã€‚</li>
                                <li>å¯ç”¨ 2M/1G å¤§é¡µæ˜¯ç°ä»£ VPP æ€§èƒ½åŸºçŸ³ã€‚</li>
                            </ul>
                        </div>
                        <div class="glass-card" style="text-align: center; border-top: 4px solid var(--secondary);">
                            <p style="font-size: 1.2rem; color: var(--text-dim);">"å†…å­˜æ˜¯ VPP çš„è¡€æ¶²ï¼Œåˆç†çš„é¢„ç•™æ˜¯ç¨³å®šæ€§çš„ç»ˆæä¿éšœã€‚"</p>
                        </div>
                    </div>
                </div>
            </div>
            <div class="slide-number">17</div>
        </div>

        <div class="slide">
            <div class="slide-header">
                <h2 class="slide-title">æ„Ÿè°¢è§‚çœ‹ï¼</h2>
            </div>
            <div class="slide-content contact-section">
                <div class="glass-card" style="display: inline-block; padding: 3rem 5rem;">
                    <div
                        style="font-size: 2.2rem; font-weight: 800; margin-bottom: 2rem; background: linear-gradient(to right, var(--primary), var(--secondary)); -webkit-background-clip: text; background-clip: text; -webkit-text-fill-color: transparent;">
                        ğŸ¯ æ¬¢è¿åŠ å…¥æŠ€æœ¯äº¤æµç¾¤
                    </div>
                    <div class="two-columns">
                        <div class="qr-container">
                            <img src="qq-group.jpg" alt="QQ ç¾¤äºŒç»´ç "
                                style="max-width: 350px; border-radius: 20px; box-shadow: 0 0 30px rgba(56, 189, 248, 0.2);">
                        </div>
                        <div style="text-align: left; line-height: 2.2; font-size: 1.4rem;">
                            <p>ğŸ’¬ <strong>æ‰«ç åŠ ç¾¤</strong> | ä¸ä¸“å®¶åŒè¡Œ</p>
                            <p>ğŸš€ <strong>åˆ†äº«ç»éªŒ</strong> | å…±åŒæˆé•¿</p>
                            <p>ğŸ“š <strong>è·å–èµ„æ–™</strong> | æ–‡æ¡£/é…ç½®</p>
                            <p>ğŸ¯ <strong>æŠ€æœ¯æ”¯æŒ</strong> | ç–‘éš¾è§£ç­”</p>
                        </div>
                    </div>
                </div>
                <div style="margin-top: 4rem; color: var(--text-dim); font-size: 1rem;">
                    Â© 2025 VPP æŠ€æœ¯åˆ†äº« | ä¸“ä¸š Â· æ·±åº¦ Â· æå®¢
                </div>
            </div>
            <div class="slide-number">18</div>
        </div>
    </div>

    <div class="navigation-hint">
        â† â†’ é”®åˆ‡æ¢å¹»ç¯ç‰‡ | ESC é€€å‡ºå…¨å±
    </div>

    <script>
        // Slide navigation
        let currentSlide = 0;
        const slides = document.querySelectorAll('.slide');
        const totalSlides = slides.length;
        const progressBar = document.getElementById('progressBar');

        function showSlide(index) {
            slides.forEach(slide => slide.classList.remove('active'));
            slides[index].classList.add('active');
            currentSlide = index;
            updateProgress();
        }

        function updateProgress() {
            const progress = ((currentSlide + 1) / totalSlides) * 100;
            progressBar.style.width = progress + '%';
        }

        function nextSlide() {
            if (currentSlide < totalSlides - 1) {
                showSlide(currentSlide + 1);
            }
        }

        function prevSlide() {
            if (currentSlide > 0) {
                showSlide(currentSlide - 1);
            }
        }

        // Keyboard navigation
        document.addEventListener('keydown', (e) => {
            if (e.key === 'ArrowRight' || e.key === ' ' || e.key === 'Enter') {
                nextSlide();
            } else if (e.key === 'ArrowLeft') {
                prevSlide();
            } else if (e.key === 'Home') {
                showSlide(0);
            } else if (e.key === 'End') {
                showSlide(totalSlides - 1);
            } else if (e.key === 'Escape') {
                if (document.fullscreenElement) {
                    document.exitFullscreen();
                }
            }
        });

        // Click navigation (click on sides)
        document.addEventListener('click', (e) => {
            const clickX = e.clientX;
            const windowWidth = window.innerWidth;

            if (clickX < windowWidth * 0.3) {
                prevSlide();
            } else if (clickX > windowWidth * 0.7) {
                nextSlide();
            }
        });

        // Touch navigation for mobile
        let touchStartX = 0;
        document.addEventListener('touchstart', (e) => {
            touchStartX = e.touches[0].clientX;
        });

        document.addEventListener('touchend', (e) => {
            const touchEndX = e.changedTouches[0].clientX;
            const diff = touchStartX - touchEndX;

            if (Math.abs(diff) > 50) {
                if (diff > 0) {
                    nextSlide();
                } else {
                    prevSlide();
                }
            }
        });

        // Initialize
        updateProgress();

        // Add fullscreen functionality
        document.addEventListener('dblclick', () => {
            if (!document.fullscreenElement) {
                document.documentElement.requestFullscreen();
            } else {
                document.exitFullscreen();
            }
        });
    </script>
</body>

</html>